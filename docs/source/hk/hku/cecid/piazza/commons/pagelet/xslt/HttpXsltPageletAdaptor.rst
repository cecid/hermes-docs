.. java:import:: hk.hku.cecid.piazza.commons.pagelet HttpPageletAdaptor

.. java:import:: hk.hku.cecid.piazza.commons.pagelet Pagelet

.. java:import:: hk.hku.cecid.piazza.commons.pagelet TemplateElement

.. java:import:: hk.hku.cecid.piazza.commons.servlet RequestListenerException

.. java:import:: java.io IOException

.. java:import:: javax.servlet.http HttpServletRequest

.. java:import:: javax.servlet.http HttpServletResponse

.. java:import:: javax.xml.transform Source

.. java:import:: javax.xml.transform Transformer

.. java:import:: javax.xml.transform TransformerException

.. java:import:: javax.xml.transform TransformerFactory

.. java:import:: javax.xml.transform.dom DOMSource

.. java:import:: javax.xml.transform.stream StreamResult

.. java:import:: javax.xml.transform.stream StreamSource

HttpXsltPageletAdaptor
======================

.. java:package:: hk.hku.cecid.piazza.commons.pagelet.xslt
   :noindex:

.. java:type:: public abstract class HttpXsltPageletAdaptor extends HttpPageletAdaptor

   HttpXsltPageletAdaptor is an HTTP pagelet adaptor which employs the XSLT technology for content rendering. It is basically same as the HTTP pagelet adpator except that all the involved pagelets, excluding the template, are XSL documents.

   This pagelet adaptor supports an additional generation mode, "xml", which suppresses the XSL transformation. If the generation mode is "xml", no rendering will be done and the output will only be a trunk of consecutive XML sources.

   :author: Hugo Y. K. Lam

Methods
-------
getErrorSource
^^^^^^^^^^^^^^

.. java:method:: protected Source getErrorSource(TemplateElement element, Throwable error, HttpServletRequest request) throws RequestListenerException
   :outertype: HttpXsltPageletAdaptor

   Gets the transformation source for the XSL error pagelet.

   :param element: the template element which represents the pagelet.
   :param error: the error generated by the XSL pagelet process.
   :param request: the servlet request.
   :throws RequestListenerException: if there was any error occurred when constructing the source.
   :return: the transformation source of the XSL error pagelet or null by default.

   **See also:** :java:ref:`.processError(TemplateElement,Throwable,HttpServletRequest,HttpServletResponse)`

getPageletSource
^^^^^^^^^^^^^^^^

.. java:method:: protected Source getPageletSource(TemplateElement element, Pagelet pagelet, HttpServletRequest request) throws RequestListenerException
   :outertype: HttpXsltPageletAdaptor

   Gets the transformation source for the given XSL pagelet.

   :param element: the template element which represents the pagelet.
   :param pagelet: the XSL pagelet.
   :param request: the servlet request.
   :throws RequestListenerException: if there was any error occurred when constructing the source.
   :return: the transformation source of the given XSL pagelet or null by default.

   **See also:** :java:ref:`.processPagelet(TemplateElement,Pagelet,HttpServletRequest,HttpServletResponse)`

processError
^^^^^^^^^^^^

.. java:method:: protected void processError(TemplateElement element, Throwable exception, HttpServletRequest request, HttpServletResponse response) throws RequestListenerException
   :outertype: HttpXsltPageletAdaptor

   Processes the error generated by the XSL pagelet. The transformation source for the XSL error pagelet will be retrieved by invoking the getErrorSource() method.

   :throws RequestListenerException: if there was any error occurred when processing the XSL error pagelet.

   **See also:** :java:ref:`.transform(Pagelet,Source,HttpServletRequest,HttpServletResponse)`, :java:ref:`.getErrorSource(TemplateElement,Throwable,HttpServletRequest)`, :java:ref:`hk.hku.cecid.piazza.commons.pagelet.HttpPageletAdaptor.processError(hk.hku.cecid.piazza.commons.pagelet.TemplateElement,java.lang.Throwable,javax.servlet.http.HttpServletRequest,javax.servlet.http.HttpServletResponse)`

processPagelet
^^^^^^^^^^^^^^

.. java:method:: protected void processPagelet(TemplateElement element, Pagelet pagelet, HttpServletRequest request, HttpServletResponse response) throws RequestListenerException
   :outertype: HttpXsltPageletAdaptor

   Processes the XSL pagelet. The transformation source for the given XSL pagelet will be retrieved by invoking the getPageletSource() method.

   :param pagelet: the XSL pagelet.
   :throws RequestListenerException: if there was any error occurred when processing the XSL pagelet.

   **See also:** :java:ref:`.transform(Pagelet,Source,HttpServletRequest,HttpServletResponse)`, :java:ref:`.getPageletSource(TemplateElement,Pagelet,HttpServletRequest)`, :java:ref:`hk.hku.cecid.piazza.commons.pagelet.HttpPageletAdaptor.processPagelet(hk.hku.cecid.piazza.commons.pagelet.TemplateElement,hk.hku.cecid.piazza.commons.pagelet.Pagelet,javax.servlet.http.HttpServletRequest,javax.servlet.http.HttpServletResponse)`

processText
^^^^^^^^^^^

.. java:method:: protected void processText(TemplateElement element, String text, HttpServletRequest request, HttpServletResponse response) throws RequestListenerException
   :outertype: HttpXsltPageletAdaptor

   Processes the text part of the generating page if the generation mode is not "xml".

   **See also:** :java:ref:`hk.hku.cecid.piazza.commons.pagelet.HttpPageletAdaptor.processText(hk.hku.cecid.piazza.commons.pagelet.TemplateElement,java.lang.String,javax.servlet.http.HttpServletRequest,javax.servlet.http.HttpServletResponse)`

transform
^^^^^^^^^

.. java:method:: protected void transform(Pagelet xsl, Source source, HttpServletRequest request, HttpServletResponse response) throws IOException, TransformerException
   :outertype: HttpXsltPageletAdaptor

   Transforms a given XML source using the specified XSL and writes the output to the response output stream.

   :param xsl: the XSL for the transformation.
   :param source: the XML source.
   :param request: the servlet request.
   :param response: the servlet response.
   :throws IOException: if an I/O exception occurs during openning the XSL stream.
   :throws TransformerException: if an unrecoverable error occurs during the course of the transformation.

